# ğŸ“š æœ¬åœ°åŒ–æ™ºèƒ½é—®ç­”ç³»ç»Ÿ (FAISSç‰ˆ)

ä¸€ä¸ªå¸®åŠ©RAGå…¥é—¨è€…ç†è§£æ ¸å¿ƒç»„ä»¶å’Œæµç¨‹çš„æœ¬åœ°åŒ–æ™ºèƒ½é—®ç­”é¡¹ç›®ã€‚

## âœ¨ åŠŸèƒ½äº®ç‚¹

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡ä¸”åŒ…å«é«˜çº§ä¼˜åŒ–çš„RAGæµç¨‹ï¼š

*   **å¤šæ ¼å¼æ•°æ®æ¥å…¥**ï¼šæ”¯æŒä¸Šä¼  `.pdf`, `.txt`, `.docx`, `.md`, `.html`, `.csv`, `.xls`, `.xlsx` ç­‰å¤šç§æ ¼å¼çš„æ–‡æ¡£ã€‚
*   **é«˜çº§æ£€ç´¢ç­–ç•¥**ï¼š
    *   **æ··åˆæ£€ç´¢**ï¼šç»“åˆ **FAISS** (è¯­ä¹‰) å’Œ **BM25** (å…³é”®è¯) æé«˜å¬å›ç‡ã€‚
    *   **é€’å½’æ£€ç´¢**ï¼šé€šè¿‡LLMè‡ªåŠ¨ç”Ÿæˆå­é—®é¢˜è¿›è¡Œå¤šè½®æŸ¥è¯¢ï¼Œæ·±æŒ–ç­”æ¡ˆã€‚
    *   **æ™ºèƒ½ç´¢å¼•**ï¼šæ ¹æ®æ–‡æ¡£æ•°é‡è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„FAISSç´¢å¼•ç±»å‹ (`IndexFlatL2`, `IndexIVFFlat`, `IndexIVFPQ`)ï¼Œå…¼é¡¾æ•ˆç‡ä¸ç²¾åº¦ã€‚
*   **ä¸¤é˜¶æ®µç²¾å‡†é‡æ’**ï¼š
    *   **ç¬¬ä¸€é˜¶æ®µ**ï¼šä½¿ç”¨ `BAAI/bge-reranker-base` **Cross-Encoder** æ¨¡å‹è¿›è¡Œé«˜æ•ˆåˆç­›ã€‚
    *   **ç¬¬äºŒé˜¶æ®µ (å¯é€‰)**ï¼šä½¿ç”¨ `deepseek-r1:1.5b` **LLM** è¿›è¡Œæœ€ç»ˆçš„ç›¸å…³æ€§åˆ¤æ–­ã€‚
*   **çµæ´»çš„LLMåç«¯**ï¼š
    *   **äº‘ç«¯ (æ¨è)**ï¼š`deepseek-ai/DeepSeek-V3` (é€šè¿‡SiliconFlow API)ã€‚
    *   **æœ¬åœ°**ï¼š`deepseek-r1:7b` (é€šè¿‡Ollama)ã€‚
*   **è”ç½‘æœç´¢å¢å¼º**ï¼šå¯é€‰é… **SerpAPI** è¿›è¡Œå®æ—¶ç½‘ç»œæœç´¢ï¼Œå¼¥è¡¥ç¦»çº¿çŸ¥è¯†çš„ä¸è¶³ã€‚
*   **ç”¨æˆ·å‹å¥½çš„ä½“éªŒ**ï¼š
    *   åŸºäº **Gradio** çš„äº¤äº’å¼Webç•Œé¢ï¼Œæ”¯æŒ**æ˜æš—ä¸»é¢˜åˆ‡æ¢**ã€‚
    *   ç­”æ¡ˆé™„å¸¦**æ¥æºæ ‡æ³¨**ï¼Œæ–¹ä¾¿æº¯æºã€‚
    *   ç›´è§‚çš„**åˆ†å—å¯è§†åŒ–**ï¼Œæ”¯æŒæŸ¥çœ‹æ¯ä¸ªæ–‡æœ¬å—çš„è¯¦ç»†å†…å®¹ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

1.  **ç¯å¢ƒå‡†å¤‡**
    ```bash
    # å®‰è£…ä¾èµ–
    pip install -r requirements.txt

    # (å¯é€‰) å‡†å¤‡æœ¬åœ°å¤§æ¨¡å‹
    # éœ€å…ˆå®‰è£… Ollama: https://ollama.com/download
    ollama pull deepseek-coder:1.3b-base
    ```

2.  **é…ç½® (å¯é€‰)**
    åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼ŒæŒ‰éœ€å¡«å…¥APIå¯†é’¥ï¼š
    ```env
    # ç”¨äºè”ç½‘æœç´¢
    SERPAPI_KEY="æ‚¨çš„SERPAPIå¯†é’¥"
    # ç”¨äºSiliconFlowäº‘ç«¯å¤§æ¨¡å‹
    SILICONFLOW_API_KEY="æ‚¨çš„SiliconFlow APIå¯†é’¥"
    ```

3.  **å¯åŠ¨åº”ç”¨**
    ```bash
    python rag_demo_pro.py
    ```
    æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® `http://127.0.0.1:17995` (æˆ–ç»ˆç«¯æç¤ºçš„åœ°å€) å³å¯å¼€å§‹ä½¿ç”¨ã€‚

## ğŸ”§ ç³»ç»Ÿæ¶æ„

```mermaid
graph TD
    subgraph "ç”¨æˆ·äº¤äº’"
        A[Gradio UI]
    end
    subgraph "æ•°æ®å¤„ç†"
        B[å¤šæ ¼å¼æ–‡æ¡£å¤„ç†/å‘é‡åŒ–]
        C[FAISS & BM25 ç´¢å¼•]
    end
    subgraph "RAGæ ¸å¿ƒæµç¨‹"
        D[æ··åˆæ£€ç´¢] --> E[é‡æ’åº Cross-Encoder+LLM]
        E --> F[é€’å½’æŸ¥è¯¢/è”ç½‘æœç´¢]
        F --> G[LLMç”Ÿæˆç­”æ¡ˆ]
    end
    
    A -- ä¸Šä¼ æ–‡æ¡£ --> B --> C
    A -- æé—® --> D
    G -- è¿”å›ç­”æ¡ˆ+æ¥æº --> A
```

## ğŸ’¡ æ ¸å¿ƒä¾èµ–ä¸æ¨¡å‹

*   **UI**: `gradio`
*   **Embeddingæ¨¡å‹**: `BAAI/bge-base-zh-v1.5`
*   **Rerankeræ¨¡å‹**: `BAAI/bge-reranker-base`
*   **LLM**: `requests` (ç”¨äºOllama/SiliconFlow API)
*   **æ•°æ®å¤„ç†**: `pdfminer.six`, `python-docx`, `beautifulsoup4`, `pandas`, `openpyxl`, `jieba`
*   **æ£€ç´¢**: `faiss-cpu`, `rank_bm25`